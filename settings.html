<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>設定 | 2weekコンタクト管理</title>
    <link rel="manifest" href="manifest.webmanifest">
    <meta name="theme-color" content="#0f172a">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=Noto+Sans+JP:wght@400;600&display=swap"
      rel="stylesheet"
    >
    <?!= include('styles'); ?>
  </head>
  <body>
    <div class="page">
      <header class="hero">
        <div class="eyebrow">設定</div>
        <h1>レンズ開始日の変更</h1>
        <p>開始日を保存すると交換日を再計算し、Googleカレンダーの予定も更新します。</p>
      </header>

      <section class="card">
        <div id="alert" class="alert" hidden></div>

        <form id="lensForm" class="form">
          <label for="startDate">レンズを装着した日</label>
          <div class="input-row">
            <input id="startDate" name="startDate" type="date" required>
            <button id="saveBtn" type="submit">保存する</button>
          </div>
          <p class="hint">2weekなので<?= lensDurationDays ?>日後に交換します。</p>
        </form>

        <div class="summary">
          <div class="summary__row">
            <div>
              <p class="label">次の交換日</p>
              <p class="date" id="replacementDisplay">--</p>
            </div>
            <div class="badge" id="countdown">開始日を入力してください</div>
          </div>
          <div class="meta">
            <div class="meta__item" id="startDisplay">開始日: --</div>
            <div class="meta__item" id="calendarStatus">カレンダー: 未登録</div>
          </div>
        </div>

        <div class="note">
          <a class="secondary-btn" href="./">ホームに戻る</a>
          <span style="margin-left:8px; color: var(--text-muted); font-size: 14px;">オフラインでも確認できるよう、ホーム画面に追加するのがおすすめです。</span>
        </div>
      </section>
    </div>

    <script>
      const LENS_DURATION_DAYS = <?= lensDurationDays ?>;
      const SCRIPT_TIMEZONE = '<?= scriptTimeZone ?>';
    </script>
    <?!= include('client'); ?>
  </body>
</html>
