<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2weekコンタクト管理</title>
    <link rel="manifest" href="manifest.webmanifest">
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0%25' stop-color='%230ea5e9'/%3E%3Cstop offset='100%25' stop-color='%236367f2'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='64' height='64' rx='14' fill='%230f172a'/%3E%3Cellipse cx='32' cy='30' rx='16' ry='12' fill='url(%23g)'/%3E%3Ccircle cx='32' cy='30' r='6' fill='%23e0f2fe'/%3E%3C/svg%3E"
    >
    <meta name="theme-color" content="#0f172a">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=Noto+Sans+JP:wght@400;600&display=swap"
      rel="stylesheet"
    >
    <?!= include('styles'); ?>
  </head>
  <body>
    <div class="page">
      <header class="hero">
        <div class="eyebrow">PWA + Googleカレンダー</div>
        <h1>2weekコンタクト管理</h1>
        <p>開始日を登録すると交換日を計算し、Googleカレンダーにも自動で予定を作成します。</p>
      </header>

      <section class="card">
        <div id="alert" class="alert" hidden></div>

        <form id="lensForm" class="form">
          <label for="startDate">レンズを装着した日</label>
          <div class="input-row">
            <input id="startDate" name="startDate" type="date" required>
            <button id="saveBtn" type="submit">保存する</button>
          </div>
          <p class="hint">2weekなので<?= lensDurationDays ?>日後に交換します。</p>
        </form>

        <div class="summary">
          <div class="summary__row">
            <div>
              <p class="label">次の交換日</p>
              <p class="date" id="replacementDisplay">--</p>
            </div>
            <div class="badge" id="countdown">開始日を入力してください</div>
          </div>
          <div class="meta">
            <div class="meta__item" id="startDisplay">開始日: --</div>
            <div class="meta__item" id="calendarStatus">カレンダー: 未登録</div>
          </div>
        </div>

        <div class="note">
          <strong>メモ:</strong> ホーム画面に追加してオフラインでも確認できます。初回アクセス時にGoogleカレンダーへのアクセス許可を求められたら許可してください。
        </div>
      </section>
    </div>

    <script>
      const LENS_DURATION_DAYS = <?= lensDurationDays ?>;
      const SCRIPT_TIMEZONE = '<?= scriptTimeZone ?>';
    </script>
    <?!= include('client'); ?>
  </body>
</html>
